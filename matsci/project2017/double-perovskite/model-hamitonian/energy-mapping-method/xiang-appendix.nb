(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     66552,       2015]
NotebookOptionsPosition[     61420,       1936]
NotebookOutlinePosition[     61776,       1952]
CellTagsIndexPosition[     61733,       1949]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"This", " ", "is", " ", "a", " ", "mathematica", " ", "script", " ", 
  
  RowBox[{"(", 
   RowBox[{"version", " ", "11.2", ".0"}], ")"}], " ", "which", " ", 
  "derivates", " ", "the", " ", "effective", " ", "exchange", " ", 
  "parameters", " ", "for", " ", "magnetic", " ", "materials", " ", 
  "according", " ", "to", " ", "the", " ", 
  RowBox[{"Appendix", ":", " ", 
   RowBox[{"Energy", "-", 
    RowBox[{
    "mapping", " ", "analysis", " ", "based", " ", "on", " ", "four", " ", 
     "ordered", " ", "spin", " ", "states", " ", "of", " ", "Hongjun", " ", 
     RowBox[{"Xiang", "'"}], "s", " ", "review", " ", "paper", " ", 
     RowBox[{"(", 
      RowBox[{"DOI", ":", 
       RowBox[{"10.1039", "/", "C2DT31662E"}]}], 
      ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Author", ":", " ", 
    RowBox[{"Yue", "-", 
     RowBox[{"Wen", " ", "FANG"}]}]}], ",", " ", 
   TemplateBox[{"\"Kyoto Daigaku\"",RowBox[{"Entity", "[", 
       RowBox[{"\"University\"", ",", "\"KyotoDaigakuJapan28829\""}], "]"}],
     "\"Entity[\\\"University\\\", \\\"KyotoDaigakuJapan28829\\\"]\"",
     "\"university\""},
    "Entity"]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.728719329743178*^9, 3.728719358461705*^9}, {
   3.728770026627656*^9, 3.7287700784193172`*^9}, 3.728772447820552*^9, {
   3.728773640817059*^9, 3.7287736750821133`*^9}, {3.728773719208955*^9, 
   3.728773740915016*^9}, {3.728773792781989*^9, 3.728773912796879*^9}, 
   3.728773999914796*^9},ExpressionUUID->"b2c4025f-2b36-44b5-9a33-\
28e2ce64e343"],

Cell[BoxData[
 RowBox[{
  RowBox[{"In", " ", "the", " ", "first", " ", "section"}], ",", " ", 
  RowBox[{
   RowBox[{
   "let", " ", "us", " ", "only", " ", "consider", " ", "the", " ", 
    "Heisenberg", " ", "Hamitonian", " ", "H"}], " ", "=", " ", 
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"i", "<", "j"}]], 
    RowBox[{
     SubscriptBox[
      StyleBox["J",
       FontWeight->"Bold"], "ij"], 
     OverscriptBox[
      SubscriptBox["S", "i"], "\[RightVector]"], 
     OverscriptBox[
      RowBox[{
       SubscriptBox["S", "j"], " "}], "\[RightVector]"]}]}]}]}]], "Input",
 CellChangeTimes->{{3.7287689849136133`*^9, 3.728768993422283*^9}, {
   3.7287690690151577`*^9, 3.728769070082198*^9}, 3.7287718788894243`*^9, {
   3.728774001779604*^9, 
   3.728774004571587*^9}},ExpressionUUID->"db3f88eb-a34b-4599-9e25-\
61b4272dc0f0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"For", " ", "state", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"S1", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S3", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S4", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"H1", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["J", "12"], 
       RowBox[{"S1", ".", "S2"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "13"], 
       RowBox[{"S1", ".", "S3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "14"], 
       RowBox[{"S1", ".", "S4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "23"], 
       RowBox[{"S2", ".", "S3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "24"], 
       RowBox[{"S2", ".", "S4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "34"], 
       RowBox[{"S3", ".", "S4"}]}]}], "//", "FullSimplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"For", " ", "state", " ", "2"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SS1", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SS2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", 
       RowBox[{"-", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SS3", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SS4", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"H2", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["J", "12"], 
       RowBox[{"SS1", ".", "SS2"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "13"], 
       RowBox[{"SS1", ".", "SS3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "14"], 
       RowBox[{"SS1", ".", "SS4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "23"], 
       RowBox[{"SS2", ".", "SS3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "24"], 
       RowBox[{"SS2", ".", "SS4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "34"], 
       RowBox[{"SS3", ".", "SS4"}]}]}], "//", "FullSimplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"For", " ", "state", " ", "3"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSS1", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSS2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSS3", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSS4", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"H3", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["J", "12"], 
       RowBox[{"SSS1", ".", "SSS2"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "13"], 
       RowBox[{"SSS1", ".", "SS3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "14"], 
       RowBox[{"SSS1", ".", "SSS4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "23"], 
       RowBox[{"SSS2", ".", "SSS3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "24"], 
       RowBox[{"SSS2", ".", "SSS4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "34"], 
       RowBox[{"SSS3", ".", "SSS4"}]}]}], "//", "FullSimplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"For", " ", "state", " ", "4"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSSS1", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSSS2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", 
       RowBox[{"-", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSSS3", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSSS4", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"H4", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["J", "12"], 
       RowBox[{"SSSS1", ".", "SSSS2"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "13"], 
       RowBox[{"SSSS1", ".", "SSSS3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "14"], 
       RowBox[{"SSSS1", ".", "SSSS4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "23"], 
       RowBox[{"SSSS2", ".", "SSSS3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "24"], 
       RowBox[{"SSSS2", ".", "SSSS4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "34"], 
       RowBox[{"SSSS3", ".", "SSSS4"}]}]}], "//", 
     "FullSimplify"}]}]}]}]], "Input",
 CellChangeTimes->{{3.728768850285481*^9, 3.7287688860994368`*^9}, {
  3.728768944967651*^9, 3.7287689614974613`*^9}, {3.728769017040307*^9, 
  3.728769204951789*^9}, {3.728769475528215*^9, 3.7287694860675907`*^9}, {
  3.728769831385293*^9, 3.728769844022051*^9}, {3.728770149953969*^9, 
  3.728770240739662*^9}, {3.7287718805412617`*^9, 
  3.728771880977672*^9}},ExpressionUUID->"54ab9477-c8d9-406f-985f-\
8fc176bad10e"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["J", "12"], "+", 
  SubscriptBox["J", "13"], "+", 
  SubscriptBox["J", "14"], "+", 
  SubscriptBox["J", "23"], "+", 
  SubscriptBox["J", "24"], "+", 
  SubscriptBox["J", "34"]}]], "Output",
 CellChangeTimes->{3.728769857703232*^9, 
  3.728770242453755*^9},ExpressionUUID->"fc017f39-0936-45b2-86c6-\
769ee1a25ed5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SubscriptBox["J", "12"]}], "+", 
  SubscriptBox["J", "13"], "+", 
  SubscriptBox["J", "14"], "-", 
  SubscriptBox["J", "23"], "-", 
  SubscriptBox["J", "24"], "+", 
  SubscriptBox["J", "34"]}]], "Output",
 CellChangeTimes->{3.728769857703232*^9, 
  3.728770242464723*^9},ExpressionUUID->"d981b095-4227-4e49-af27-\
b98c0a793f16"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SubscriptBox["J", "12"]}], "-", 
  SubscriptBox["J", "13"], "-", 
  SubscriptBox["J", "14"], "+", 
  SubscriptBox["J", "23"], "+", 
  SubscriptBox["J", "24"], "+", 
  SubscriptBox["J", "34"]}]], "Output",
 CellChangeTimes->{3.728769857703232*^9, 
  3.728770242471908*^9},ExpressionUUID->"8bc2af18-056d-4e15-baa3-\
70bb36da5a2a"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["J", "12"], "-", 
  SubscriptBox["J", "13"], "-", 
  SubscriptBox["J", "14"], "-", 
  SubscriptBox["J", "23"], "-", 
  SubscriptBox["J", "24"], "+", 
  SubscriptBox["J", "34"]}]], "Output",
 CellChangeTimes->{3.728769857703232*^9, 
  3.728770242478709*^9},ExpressionUUID->"c976d981-9f7b-4a66-a8f8-\
b45852b13293"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"H1", "+", "H4", "-", "H2", "-", "H3"}], ")"}], "/", "4", "  ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"This", " ", 
     RowBox[{
      RowBox[{"is", " ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"E1", "+", "E4"}], ")"}], "-", 
        RowBox[{"(", 
         RowBox[{"E2", "+", "E3"}], ")"}]}], "]"}], "/", "4"}], " ", "in", 
     " ", 
     RowBox[{"Xiang", "'"}], "s", " ", "paper"}], ",", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "equation"}], " ", "A3"}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.7287695602809763`*^9, 3.728769575909912*^9}, {
  3.728769638011526*^9, 3.728769647874094*^9}, {3.728774081401267*^9, 
  3.728774104516325*^9}},ExpressionUUID->"848a52a9-dc82-4615-8eaa-\
852127824fb8"],

Cell[BoxData[
 SubscriptBox["J", "12"]], "Output",
 CellChangeTimes->{{3.728769561105006*^9, 3.728769595370778*^9}, {
   3.7287696405301313`*^9, 3.728769648165649*^9}, 3.7287697144358053`*^9, 
   3.7287698608243437`*^9, 
   3.728770245687581*^9},ExpressionUUID->"b8c3b044-ca64-4c21-b3d8-\
a35a1c8b231e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"H1", "+", "H2", "+", "H3", "+", "H4"}], ")"}], "/", "4", " ", 
  RowBox[{"(*", 
   RowBox[{"This", " ", 
    RowBox[{
     RowBox[{"is", " ", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"E1", "+", "E4"}], ")"}], "+", 
       RowBox[{"(", 
        RowBox[{"E2", "+", "E3"}], ")"}]}], "]"}], "/", "4"}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.728769616351777*^9, 3.728769619550407*^9}, {
  3.7287740846116867`*^9, 
  3.7287740873464117`*^9}},ExpressionUUID->"71cccd8e-d357-4b7a-a7af-\
0ec36a9aff47"],

Cell[BoxData[
 SubscriptBox["J", "34"]], "Output",
 CellChangeTimes->{3.728769620265029*^9, 3.728769716502838*^9, 
  3.72876986236757*^9, 3.7287699704427843`*^9, 
  3.728770247271893*^9},ExpressionUUID->"a27ab67a-f87e-41c7-a0a1-\
d851d9486bfa"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"In", " ", "this", " ", "section"}], ",", " ", 
  RowBox[{
  "let", " ", "us", " ", "only", " ", "consider", " ", "the", " ", "DM", " ", 
   "spin", " ", 
   RowBox[{"exchange", ".", " ", "To"}], " ", "calculate", " ", "D"}], ",", 
  " ", 
  RowBox[{
  "SOC", " ", "should", " ", "be", " ", "included", " ", "in", " ", "DFT", 
   " ", 
   RowBox[{"calculations", ".", " ", "In"}], " ", "this", " ", "case"}], ",", 
  " ", 
  RowBox[{
   RowBox[{"the", " ", "Hamitonian", " ", "becomes", " ", "H"}], " ", "=", 
   " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Sum]", 
       RowBox[{"i", "<", "j"}]], 
      RowBox[{
       SubscriptBox[
        StyleBox["J",
         FontWeight->"Bold"], "ij"], 
       OverscriptBox[
        SubscriptBox["S", "i"], "\[RightVector]"], 
       OverscriptBox[
        RowBox[{
         SubscriptBox["S", "j"], " "}], "\[RightVector]"]}]}], "+", " ", 
     RowBox[{
      SubscriptBox["\[Sum]", 
       RowBox[{"i", "<", "j"}]], 
      RowBox[{
       OverscriptBox[
        SubscriptBox["D", "ij"], "\[RightVector]"], 
       OverscriptBox[
        SubscriptBox["S", "i"], "\[RightVector]"], 
       OverscriptBox[
        RowBox[{
         SubscriptBox["S", "j"], " "}], "\[RightVector]"]}]}]}], " ", "=", 
    RowBox[{
     RowBox[{"H", " ", "term"}], " ", "+", " ", 
     RowBox[{"D", " ", "term"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"To", " ", "input", " ", 
   OverscriptBox["D", "\[RightVector]"]}], ",", 
  RowBox[{
   RowBox[{
    RowBox[{"Type", " ", "ctrl"}], " ", "+"}], "&"}], ",", " ", 
  RowBox[{
   RowBox[{"and", " ", "then", " ", "esc"}], "+", "vec", "+", 
   RowBox[{"esc", ":"}]}]}]}], "Input",
 CellChangeTimes->{{3.7287718144379997`*^9, 3.728771848498807*^9}, {
  3.728772029971212*^9, 3.728772098272729*^9}, {3.728772398769665*^9, 
  3.7287724409561367`*^9}, {3.728772483544989*^9, 3.728772493234293*^9}, {
  3.728772663895323*^9, 
  3.728772729001524*^9}},ExpressionUUID->"89e49607-9600-4db3-a340-\
f73e540bf67d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"In", " ", "this", " ", "subsection"}], ",", " ", 
    RowBox[{
     RowBox[{"let", " ", "us", " ", "consider", " ", "the", " ", "z"}], "-", 
     RowBox[{"component", " ", "of", " ", "D"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"For", " ", "state", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"S1", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S3", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S4", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"H1", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["J", "12"], 
       RowBox[{"S1", ".", "S2"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "13"], 
       RowBox[{"S1", ".", "S3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "14"], 
       RowBox[{"S1", ".", "S4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "23"], 
       RowBox[{"S2", ".", "S3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "24"], 
       RowBox[{"S2", ".", "S4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "34"], 
       RowBox[{"S3", ".", "S4"}]}]}], "//", "FullSimplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"D1", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["D", "12"], ".", 
       RowBox[{"(", 
        RowBox[{"S1", "\[Cross]", "S2"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["D", "13"], ".", 
       RowBox[{"(", 
        RowBox[{"S1", "\[Cross]", "S3"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "14"], ".", 
       RowBox[{"(", 
        RowBox[{"S1", "\[Cross]", "S4"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "23"], ".", 
       RowBox[{"(", 
        RowBox[{"S2", "\[Cross]", "S3"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "24"], ".", 
       RowBox[{"(", 
        RowBox[{"S2", "\[Cross]", "S4"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "34"], ".", 
       RowBox[{"(", 
        RowBox[{"S3", "\[Cross]", "S4"}], ")"}]}]}], "//", "FullSimplify"}]}],
    " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Although", " ", "I", " ", 
      RowBox[{"don", "'"}], "t", " ", "put", " ", "arrows", " ", "on", " ", 
      SubscriptBox["D", "ij"]}], ",", " ", 
     RowBox[{"actually", " ", "they", " ", "are", " ", "vectors"}], ",", " ", 
     
     RowBox[{"the", " ", "correct", " ", "form", " ", "is", " ", 
      RowBox[{
       SubscriptBox["D", "ij"], ".", " ", "Here"}]}], ",", " ", 
     RowBox[{"I", " ", "juse", " ", "use", " ", 
      SubscriptBox["D", "ij"], " ", "for", " ", "simple", " ", "coding"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"For", " ", "state", " ", "2"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SS1", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SS2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "0"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SS3", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SS4", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"H2", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["J", "12"], 
       RowBox[{"SS1", ".", "SS2"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "13"], 
       RowBox[{"SS1", ".", "SS3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "14"], 
       RowBox[{"SS1", ".", "SS4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "23"], 
       RowBox[{"SS2", ".", "SS3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "24"], 
       RowBox[{"SS2", ".", "SS4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "34"], 
       RowBox[{"SS3", ".", "SS4"}]}]}], "//", "FullSimplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"D2", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["D", "12"], ".", 
       RowBox[{"(", 
        RowBox[{"SS1", "\[Cross]", "SS2"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["D", "13"], ".", 
       RowBox[{"(", 
        RowBox[{"SS1", "\[Cross]", "SS3"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "14"], ".", 
       RowBox[{"(", 
        RowBox[{"SS1", "\[Cross]", "SS4"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "23"], ".", 
       RowBox[{"(", 
        RowBox[{"SS2", "\[Cross]", "SS3"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "24"], ".", 
       RowBox[{"(", 
        RowBox[{"SS2", "\[Cross]", "SS4"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "34"], ".", 
       RowBox[{"(", 
        RowBox[{"SS3", "\[Cross]", "SS4"}], ")"}]}]}], "//", 
     "FullSimplify"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"For", " ", "state", " ", "3"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSS1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSS2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSS3", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSS4", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"H3", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["J", "12"], 
       RowBox[{"SSS1", ".", "SSS2"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "13"], 
       RowBox[{"SSS1", ".", "SS3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "14"], 
       RowBox[{"SSS1", ".", "SSS4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "23"], 
       RowBox[{"SSS2", ".", "SSS3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "24"], 
       RowBox[{"SSS2", ".", "SSS4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "34"], 
       RowBox[{"SSS3", ".", "SSS4"}]}]}], "//", "FullSimplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"D3", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["D", "12"], ".", 
       RowBox[{"(", 
        RowBox[{"SSS1", "\[Cross]", "SSS2"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["D", "13"], ".", 
       RowBox[{"(", 
        RowBox[{"SSS1", "\[Cross]", "SSS3"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "14"], ".", 
       RowBox[{"(", 
        RowBox[{"SSS1", "\[Cross]", "SSS4"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "23"], ".", 
       RowBox[{"(", 
        RowBox[{"SSS2", "\[Cross]", "SSS3"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "24"], ".", 
       RowBox[{"(", 
        RowBox[{"SSS2", "\[Cross]", "SSS4"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "34"], ".", 
       RowBox[{"(", 
        RowBox[{"SSS3", "\[Cross]", "SSS4"}], ")"}]}]}], "//", 
     "FullSimplify"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"For", " ", "state", " ", "4"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSSS1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSSS2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"SSSS3", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSSS4", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"H4", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["J", "12"], 
       RowBox[{"SSSS1", ".", "SSSS2"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "13"], 
       RowBox[{"SSSS1", ".", "SSSS3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "14"], 
       RowBox[{"SSSS1", ".", "SSSS4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "23"], 
       RowBox[{"SSSS2", ".", "SSSS3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "24"], 
       RowBox[{"SSSS2", ".", "SSSS4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "34"], 
       RowBox[{"SSSS3", ".", "SSSS4"}]}]}], "//", "FullSimplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"D4", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["D", "12"], ".", 
       RowBox[{"(", 
        RowBox[{"SSSS1", "\[Cross]", "SSSS2"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["D", "13"], ".", 
       RowBox[{"(", 
        RowBox[{"SSSS1", "\[Cross]", "SSSS3"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "14"], ".", 
       RowBox[{"(", 
        RowBox[{"SSSS1", "\[Cross]", "SSSS4"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "23"], ".", 
       RowBox[{"(", 
        RowBox[{"SSSS2", "\[Cross]", "SSSS3"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "24"], ".", 
       RowBox[{"(", 
        RowBox[{"SSSS2", "\[Cross]", "SSSS4"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "34"], ".", 
       RowBox[{"(", 
        RowBox[{"SSSS3", "\[Cross]", "SSSS4"}], ")"}]}]}], "//", 
     "FullSimplify"}]}]}]}]], "Input",
 CellChangeTimes->{{3.728771904774948*^9, 3.728771954061371*^9}, {
  3.728772496456709*^9, 3.728772527181364*^9}, {3.728772742944003*^9, 
  3.728772744118918*^9}, {3.728772787891446*^9, 3.728772945717429*^9}, {
  3.728773068123809*^9, 3.7287730684905148`*^9}, {3.728773211236866*^9, 
  3.7287732286723547`*^9}, {3.728773372402794*^9, 
  3.728773435917304*^9}},ExpressionUUID->"6beb5fd1-0898-4e28-b54a-\
d87b27b29ca1"],

Cell[BoxData[
 SubscriptBox["J", "34"]], "Output",
 CellChangeTimes->{3.728771968978014*^9, 3.728772949696349*^9, 
  3.7287730702016706`*^9},ExpressionUUID->"88dbcfe6-2b05-4711-8eb0-\
cc147c8cafb1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["D", "12"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["D", "13"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "14"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "23"], ".", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "24"], ".", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "34"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}]], "Output",
 CellChangeTimes->{3.728771968978014*^9, 3.728772949696349*^9, 
  3.728773070209676*^9},ExpressionUUID->"a8ed7243-7b90-40bc-bc1e-\
fb7c411c866a"],

Cell[BoxData[
 SubscriptBox["J", "34"]], "Output",
 CellChangeTimes->{3.728771968978014*^9, 3.728772949696349*^9, 
  3.728773070214731*^9},ExpressionUUID->"9935cebc-cff5-4517-9172-\
056e827861fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["D", "12"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["D", "13"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "14"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "23"], ".", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "24"], ".", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "34"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}]], "Output",
 CellChangeTimes->{3.728771968978014*^9, 3.728772949696349*^9, 
  3.728773070222105*^9},ExpressionUUID->"cdcb9133-701d-4a9e-8e45-\
f645b29d170d"],

Cell[BoxData[
 SubscriptBox["J", "34"]], "Output",
 CellChangeTimes->{3.728771968978014*^9, 3.728772949696349*^9, 
  3.728773070229391*^9},ExpressionUUID->"a865b86a-8b4e-42ab-98fb-\
182ffb551cdd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["D", "12"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["D", "13"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "14"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "23"], ".", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "24"], ".", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "34"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}]], "Output",
 CellChangeTimes->{3.728771968978014*^9, 3.728772949696349*^9, 
  3.728773070236907*^9},ExpressionUUID->"8108299c-9eea-4567-bf55-\
b47fadea2997"],

Cell[BoxData[
 SubscriptBox["J", "34"]], "Output",
 CellChangeTimes->{3.728771968978014*^9, 3.728772949696349*^9, 
  3.7287730702454357`*^9},ExpressionUUID->"353c14d7-2389-4e5d-b9df-\
0a77f6b0aaf5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["D", "12"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["D", "13"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "14"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "23"], ".", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "24"], ".", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "34"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}]], "Output",
 CellChangeTimes->{3.728771968978014*^9, 3.728772949696349*^9, 
  3.728773070253345*^9},ExpressionUUID->"133bafd2-204b-4b1b-8fb3-\
7b4ec78c1a9a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
   "H1", "+", "D1", "+", "H4", "+", "D4", "-", "H2", "-", "D2", "-", "H3", 
    "-", "D3"}], ")"}], "/", "4", " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"This", " ", 
     RowBox[{
      RowBox[{"is", " ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"E1", "+", "E4"}], ")"}], "-", 
        RowBox[{"(", 
         RowBox[{"E2", "+", "E3"}], ")"}]}], "]"}], "/", "4"}], " ", "in", 
     " ", 
     RowBox[{"Xiang", "'"}], "s", " ", "paper"}], ",", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "equation"}], " ", "A4"}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.7287723479643*^9, 3.7287723790712643`*^9}, {
   3.728773027766638*^9, 3.7287730615815287`*^9}, {3.728773484796865*^9, 
   3.728773512372707*^9}, 3.728774111949851*^9, {3.728776204327085*^9, 
   3.728776204654546*^9}},ExpressionUUID->"39581327-84c9-4c38-b330-\
51ff37cfeb59"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{
      SubscriptBox["D", "12"], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["D", "12"], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.728773077394828*^9},ExpressionUUID->"55c91875-5f8b-4763-b739-\
72aaad4b4a5d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Since", " ", "the", " ", "z", " ", "component", " ", "of", " ", 
   OverscriptBox[
    RowBox[{
     SubscriptBox["D", "12"], " "}], "\[RightVector]"], "has", " ", "the", 
   " ", "vector", " ", "form", " ", "of", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", " ", "0", ",", " ", 
     SuperscriptBox["D12", "z"]}], "}"}]}], ",", "\[IndentingNewLine]", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      RowBox[{
       SubscriptBox["D", "12"], ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"-", "1"}]}], "}"}]}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["D", "12"], ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], ")"}], " ", "can", 
   " ", "be", " ", "converted", " ", "to"}]}]], "Input",
 CellChangeTimes->{{3.728773179801824*^9, 3.728773184761804*^9}, {
  3.728773233787517*^9, 3.7287732786331377`*^9}, {3.7287733200938387`*^9, 
  3.728773342763722*^9}, {3.728773466411401*^9, 
  3.7287734694083443`*^9}},ExpressionUUID->"1090f885-4701-44b0-aa36-\
7aa8c710976d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "0", ",", " ", 
        SuperscriptBox["D12", "z"]}], "}"}], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}]}], "+", 
    RowBox[{"2", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "0", ",", " ", 
        SuperscriptBox["D12", "z"]}], "}"}], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], ")"}], " "}]], "Input",\

 CellChangeTimes->{{3.728773351373096*^9, 3.728773357129766*^9}, {
  3.728773461350877*^9, 
  3.7287734744322*^9}},ExpressionUUID->"91627650-7300-41dc-9289-ecff7a51d216"],

Cell[BoxData[
 SuperscriptBox["D12", "z"]], "Output",
 CellChangeTimes->{
  3.728773474941936*^9},ExpressionUUID->"c84c3adc-c6f2-4632-89c8-\
a3a346499c64"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"In", " ", "this", " ", "section"}], ",", " ", 
  RowBox[{
   RowBox[{
   "the", " ", "hamitonian", " ", "takes", " ", "into", " ", "consideration", 
    " ", "of", " ", "the", " ", "single"}], "-", 
   RowBox[{"ion", " ", "anisotropy", " ", 
    RowBox[{
     RowBox[{"(", "SIA", ")"}], ".", " ", "\[IndentingNewLine]", "For"}], " ",
     "a", " ", "given", " ", "ion"}]}], ",", " ", 
  RowBox[{
   RowBox[{"the", " ", "single"}], "-", 
   RowBox[{
   "ion", " ", "anisotropy", " ", "term", " ", "can", " ", "be", " ", 
    "written", " ", "as"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"SIA", " ", "=", " ", 
  RowBox[{
   RowBox[{
    SubsuperscriptBox["A", 
     RowBox[{"i", ",", "xx"}], "e"], 
    SubsuperscriptBox["S", "x", "2"]}], "+", 
   RowBox[{
    SubsuperscriptBox["A", 
     RowBox[{"i", ",", "yy"}], "e"], 
    SubsuperscriptBox["S", "y", "2"]}], "+", 
   RowBox[{
    SubsuperscriptBox["A", 
     RowBox[{"i", ",", "zz"}], "e"], 
    SubsuperscriptBox["S", "z", "2"]}], "+", 
   RowBox[{"2", 
    SubsuperscriptBox["A", 
     RowBox[{"i", ",", "xy"}], "e"], 
    SubscriptBox["S", "x"], 
    SubscriptBox["S", "y"]}], "+", 
   RowBox[{"2", 
    SubsuperscriptBox["A", 
     RowBox[{"i", ",", "xz"}], "e"], 
    SubscriptBox["S", "x"], 
    SubscriptBox["S", "z"]}], "+", 
   RowBox[{"2", 
    SubsuperscriptBox["A", 
     RowBox[{"i", ",", "yz"}], "e"], 
    SubscriptBox["S", "y"], 
    SubscriptBox["S", "z"]}]}]}]}], "Input",
 CellChangeTimes->{{3.728774565763104*^9, 3.728774606576408*^9}, {
  3.728774788860656*^9, 3.728774875913759*^9}, {3.728775081763135*^9, 
  3.728775278325089*^9}, {3.728775325468251*^9, 3.728775346082152*^9}, {
  3.728775522580028*^9, 
  3.7287755288648987`*^9}},ExpressionUUID->"6f512e01-619b-479a-bf46-\
2876c7a1cf5a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"a", ")"}], " ", "If", " ", "the", " ", "ion", " ", "has", " ", 
    "easy"}], "-", 
   RowBox[{"axis", " ", 
    RowBox[{"(", 
     RowBox[{"say", " ", "along", " ", "z", " ", "direction"}], ")"}], " ", 
    "or", " ", "easy"}], "-", 
   RowBox[{"plane", " ", "anisotropy"}]}], ",", " ", 
  RowBox[{
  "SIA", " ", "can", " ", "be", " ", "simplied", " ", 
   "as"}]}], "\[IndentingNewLine]", 
 RowBox[{"SIA", "=", " ", 
  RowBox[{
   SubsuperscriptBox["A", "i", "e"], 
   SubsuperscriptBox["S", "z", "2"]}]}]}], "Input",
 CellChangeTimes->{
  3.728774857774043*^9, 3.728775145237936*^9, {3.72877535876711*^9, 
   3.728775439032596*^9}},ExpressionUUID->"929a2f1e-0d08-4e7c-bead-\
e05a3a113949"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"For", " ", "state", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"S1", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S3", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S4", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"H1", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["J", "12"], 
       RowBox[{"S1", ".", "S2"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "13"], 
       RowBox[{"S1", ".", "S3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "14"], 
       RowBox[{"S1", ".", "S4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "23"], 
       RowBox[{"S2", ".", "S3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "24"], 
       RowBox[{"S2", ".", "S4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "34"], 
       RowBox[{"S3", ".", "S4"}]}]}], "//", "FullSimplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"D1", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["D", "12"], ".", 
       RowBox[{"(", 
        RowBox[{"S1", "\[Cross]", "S2"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["D", "13"], ".", 
       RowBox[{"(", 
        RowBox[{"S1", "\[Cross]", "S3"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "14"], ".", 
       RowBox[{"(", 
        RowBox[{"S1", "\[Cross]", "S4"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "23"], ".", 
       RowBox[{"(", 
        RowBox[{"S2", "\[Cross]", "S3"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "24"], ".", 
       RowBox[{"(", 
        RowBox[{"S2", "\[Cross]", "S4"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "34"], ".", 
       RowBox[{"(", 
        RowBox[{"S3", "\[Cross]", "S4"}], ")"}]}]}], "//", "FullSimplify"}]}],
    " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Although", " ", "I", " ", 
      RowBox[{"don", "'"}], "t", " ", "put", " ", "arrows", " ", "on", " ", 
      SubscriptBox["D", "ij"]}], ",", " ", 
     RowBox[{"actually", " ", "they", " ", "are", " ", "vectors"}], ",", " ", 
     
     RowBox[{"the", " ", "correct", " ", "form", " ", "is", " ", 
      RowBox[{
       SubscriptBox["D", "ij"], ".", " ", "Here"}]}], ",", " ", 
     RowBox[{"I", " ", "juse", " ", "use", " ", 
      SubscriptBox["D", "ij"], " ", "for", " ", "simple", " ", "coding"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"SIA1", " ", "=", " ", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["A", "1", "e"], 
      SuperscriptBox["1", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["A", "2", "e"], 
      SuperscriptBox["1", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["A", "3", "e"], 
      SuperscriptBox["1", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["A", "4", "e"], 
      SuperscriptBox["1", "2"]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"For", " ", "state", " ", "2"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SS1", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SS2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SS3", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SS4", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"H2", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["J", "12"], 
       RowBox[{"SS1", ".", "SS2"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "13"], 
       RowBox[{"SS1", ".", "SS3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "14"], 
       RowBox[{"SS1", ".", "SS4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "23"], 
       RowBox[{"SS2", ".", "SS3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "24"], 
       RowBox[{"SS2", ".", "SS4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "34"], 
       RowBox[{"SS3", ".", "SS4"}]}]}], "//", "FullSimplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"D2", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["D", "12"], ".", 
       RowBox[{"(", 
        RowBox[{"SS1", "\[Cross]", "SS2"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["D", "13"], ".", 
       RowBox[{"(", 
        RowBox[{"SS1", "\[Cross]", "SS3"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "14"], ".", 
       RowBox[{"(", 
        RowBox[{"SS1", "\[Cross]", "SS4"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "23"], ".", 
       RowBox[{"(", 
        RowBox[{"SS2", "\[Cross]", "SS3"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "24"], ".", 
       RowBox[{"(", 
        RowBox[{"SS2", "\[Cross]", "SS4"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "34"], ".", 
       RowBox[{"(", 
        RowBox[{"SS3", "\[Cross]", "SS4"}], ")"}]}]}], "//", 
     "FullSimplify"}]}], "\[IndentingNewLine]", 
   RowBox[{"SIA2", " ", "=", " ", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["A", "1", "e"], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["A", "2", "e"], 
      SuperscriptBox["1", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["A", "3", "e"], 
      SuperscriptBox["1", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["A", "4", "e"], 
      SuperscriptBox["1", "2"]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"For", " ", "state", " ", "3"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSS1", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSS2", " ", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSS3", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSS4", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"H3", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["J", "12"], 
       RowBox[{"SSS1", ".", "SSS2"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "13"], 
       RowBox[{"SSS1", ".", "SS3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "14"], 
       RowBox[{"SSS1", ".", "SSS4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "23"], 
       RowBox[{"SSS2", ".", "SSS3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "24"], 
       RowBox[{"SSS2", ".", "SSS4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "34"], 
       RowBox[{"SSS3", ".", "SSS4"}]}]}], "//", "FullSimplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"D3", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["D", "12"], ".", 
       RowBox[{"(", 
        RowBox[{"SSS1", "\[Cross]", "SSS2"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["D", "13"], ".", 
       RowBox[{"(", 
        RowBox[{"SSS1", "\[Cross]", "SSS3"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "14"], ".", 
       RowBox[{"(", 
        RowBox[{"SSS1", "\[Cross]", "SSS4"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "23"], ".", 
       RowBox[{"(", 
        RowBox[{"SSS2", "\[Cross]", "SSS3"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "24"], ".", 
       RowBox[{"(", 
        RowBox[{"SSS2", "\[Cross]", "SSS4"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "34"], ".", 
       RowBox[{"(", 
        RowBox[{"SSS3", "\[Cross]", "SSS4"}], ")"}]}]}], "//", 
     "FullSimplify"}]}], "\[IndentingNewLine]", 
   RowBox[{"SIA3", " ", "=", " ", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["A", "1", "e"], 
      SuperscriptBox[
       RowBox[{"(", "0", ")"}], "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["A", "2", "e"], 
      SuperscriptBox["1", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["A", "3", "e"], 
      SuperscriptBox["1", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["A", "4", "e"], 
      SuperscriptBox["1", "2"]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"For", " ", "state", " ", "4"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSSS1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSSS2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSSS3", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SSSS4", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"H4", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["J", "12"], 
       RowBox[{"SSSS1", ".", "SSSS2"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "13"], 
       RowBox[{"SSSS1", ".", "SSSS3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "14"], 
       RowBox[{"SSSS1", ".", "SSSS4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "23"], 
       RowBox[{"SSSS2", ".", "SSSS3"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "24"], 
       RowBox[{"SSSS2", ".", "SSSS4"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "34"], 
       RowBox[{"SSSS3", ".", "SSSS4"}]}]}], "//", "FullSimplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"D4", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["D", "12"], ".", 
       RowBox[{"(", 
        RowBox[{"SSSS1", "\[Cross]", "SSSS2"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["D", "13"], ".", 
       RowBox[{"(", 
        RowBox[{"SSSS1", "\[Cross]", "SSSS3"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "14"], ".", 
       RowBox[{"(", 
        RowBox[{"SSSS1", "\[Cross]", "SSSS4"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "23"], ".", 
       RowBox[{"(", 
        RowBox[{"SSSS2", "\[Cross]", "SSSS3"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "24"], ".", 
       RowBox[{"(", 
        RowBox[{"SSSS2", "\[Cross]", "SSSS4"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["J", "34"], ".", 
       RowBox[{"(", 
        RowBox[{"SSSS3", "\[Cross]", "SSSS4"}], ")"}]}]}], "//", 
     "FullSimplify"}]}], "\[IndentingNewLine]", 
   RowBox[{"SIA4", "=", " ", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["A", "1", "e"], 
      SuperscriptBox[
       RowBox[{"(", "0", ")"}], "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["A", "2", "e"], 
      SuperscriptBox["1", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["A", "3", "e"], 
      SuperscriptBox["1", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["A", "4", "e"], 
      SuperscriptBox["1", "2"]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.728775712834073*^9, 3.728775749084609*^9}, {
  3.728775817974313*^9, 3.728775859818654*^9}, {3.7287759079855223`*^9, 
  3.728776065949873*^9}, {3.728776100176057*^9, 
  3.728776131580063*^9}},ExpressionUUID->"ef5b8695-e9c2-417b-b7dd-\
34b7faf5936b"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["J", "12"], "+", 
  SubscriptBox["J", "13"], "+", 
  SubscriptBox["J", "14"], "+", 
  SubscriptBox["J", "23"], "+", 
  SubscriptBox["J", "24"], "+", 
  SubscriptBox["J", "34"]}]], "Output",
 CellChangeTimes->{
  3.7287757629051743`*^9, 3.728776069687645*^9, {3.7287761047646627`*^9, 
   3.728776132451798*^9}},ExpressionUUID->"2b31dcb7-ca87-49cd-88ee-\
9c1d2e07e9e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["D", "12"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["D", "13"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "14"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "23"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "24"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "34"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}]], "Output",
 CellChangeTimes->{
  3.7287757629051743`*^9, 3.728776069687645*^9, {3.7287761047646627`*^9, 
   3.728776132459302*^9}},ExpressionUUID->"a99b1211-4bbe-4455-944c-\
c9d2fb00f363"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["A", "1", "e"], "+", 
  SubsuperscriptBox["A", "2", "e"], "+", 
  SubsuperscriptBox["A", "3", "e"], "+", 
  SubsuperscriptBox["A", "4", "e"]}]], "Output",
 CellChangeTimes->{
  3.7287757629051743`*^9, 3.728776069687645*^9, {3.7287761047646627`*^9, 
   3.7287761324643173`*^9}},ExpressionUUID->"1f865311-f1f5-4c63-ad92-\
3ab7234305c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SubscriptBox["J", "12"]}], "-", 
  SubscriptBox["J", "13"], "-", 
  SubscriptBox["J", "14"], "+", 
  SubscriptBox["J", "23"], "+", 
  SubscriptBox["J", "24"], "+", 
  SubscriptBox["J", "34"]}]], "Output",
 CellChangeTimes->{
  3.7287757629051743`*^9, 3.728776069687645*^9, {3.7287761047646627`*^9, 
   3.728776132469623*^9}},ExpressionUUID->"b9747836-4a3f-4a66-95a9-\
64f66277be09"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["D", "12"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["D", "13"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "14"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "23"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "24"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "34"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}]], "Output",
 CellChangeTimes->{
  3.7287757629051743`*^9, 3.728776069687645*^9, {3.7287761047646627`*^9, 
   3.728776132474648*^9}},ExpressionUUID->"f52a976b-e249-4d84-a317-\
b8684facc25c"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["A", "1", "e"], "+", 
  SubsuperscriptBox["A", "2", "e"], "+", 
  SubsuperscriptBox["A", "3", "e"], "+", 
  SubsuperscriptBox["A", "4", "e"]}]], "Output",
 CellChangeTimes->{
  3.7287757629051743`*^9, 3.728776069687645*^9, {3.7287761047646627`*^9, 
   3.728776132480775*^9}},ExpressionUUID->"fac71ba9-6a40-4764-baff-\
bdc348d60c5c"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["J", "23"], "+", 
  SubscriptBox["J", "24"], "+", 
  SubscriptBox["J", "34"]}]], "Output",
 CellChangeTimes->{
  3.7287757629051743`*^9, 3.728776069687645*^9, {3.7287761047646627`*^9, 
   3.728776132486549*^9}},ExpressionUUID->"802db2e6-91c1-4056-a7f6-\
e539453bacc6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["D", "12"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["D", "13"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "14"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "23"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "24"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "34"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}]], "Output",
 CellChangeTimes->{
  3.7287757629051743`*^9, 3.728776069687645*^9, {3.7287761047646627`*^9, 
   3.728776132492305*^9}},ExpressionUUID->"6343ad90-45cb-4230-9f84-\
1cc1c0867393"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["A", "2", "e"], "+", 
  SubsuperscriptBox["A", "3", "e"], "+", 
  SubsuperscriptBox["A", "4", "e"]}]], "Output",
 CellChangeTimes->{
  3.7287757629051743`*^9, 3.728776069687645*^9, {3.7287761047646627`*^9, 
   3.728776132497759*^9}},ExpressionUUID->"e9e3545a-630d-4966-86af-\
104bdfc14811"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["J", "23"], "+", 
  SubscriptBox["J", "24"], "+", 
  SubscriptBox["J", "34"]}]], "Output",
 CellChangeTimes->{
  3.7287757629051743`*^9, 3.728776069687645*^9, {3.7287761047646627`*^9, 
   3.728776132502713*^9}},ExpressionUUID->"2a4db106-fcb7-42fd-a85a-\
2e44a4ee8d40"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["D", "12"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["D", "13"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "14"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "23"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "24"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "+", 
  RowBox[{
   SubscriptBox["J", "34"], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}]], "Output",
 CellChangeTimes->{
  3.7287757629051743`*^9, 3.728776069687645*^9, {3.7287761047646627`*^9, 
   3.728776132508129*^9}},ExpressionUUID->"93a671ac-ec30-4510-97cf-\
05e83f814854"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["A", "2", "e"], "+", 
  SubsuperscriptBox["A", "3", "e"], "+", 
  SubsuperscriptBox["A", "4", "e"]}]], "Output",
 CellChangeTimes->{
  3.7287757629051743`*^9, 3.728776069687645*^9, {3.7287761047646627`*^9, 
   3.72877613251375*^9}},ExpressionUUID->"87ff0f09-efba-45e3-87f9-\
c0a5ea46d1aa"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Then", " ", "we", " ", "have"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "H1", "+", "D1", "+", "SIA1", "+", "H2", "+", "D2", "+", "SIA2", "-", 
       "H3", "-", "D3", "-", "SIA3", "-", "H4", "-", "D4", "-", "SIA4"}], 
      ")"}], "/", "2"}], " ", "//", "FullSimplify"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"This", " ", 
      RowBox[{
       RowBox[{"is", " ", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"E1", "+", "E4"}], ")"}], "-", 
         RowBox[{"(", 
          RowBox[{"E2", "+", "E3"}], ")"}]}], "]"}], "/", "4"}], " ", "in", 
      " ", 
      RowBox[{"Xiang", "'"}], "s", " ", "paper"}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "equation"}], " ", "A9"}]}], "*)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.728776148844602*^9, 3.728776188757751*^9}, {
  3.72877621942276*^9, 3.7287762471569233`*^9}, {3.7287764602357607`*^9, 
  3.7287764729496307`*^9}, {3.728776616808886*^9, 
  3.7287766169956837`*^9}},ExpressionUUID->"db0075c0-ddd5-4819-a8b7-\
8aa54d8a4daa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      SubscriptBox["D", "12"], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}]}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["D", "12"], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "-", 
    RowBox[{
     SubscriptBox["D", "12"], ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "-", 
    RowBox[{
     SubscriptBox["D", "13"], ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["D", "13"], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "-", 
    RowBox[{
     SubscriptBox["D", "13"], ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "-", 
    RowBox[{
     SubscriptBox["J", "14"], ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["J", "14"], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "-", 
    RowBox[{
     SubscriptBox["J", "14"], ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "+", 
    RowBox[{"2", " ", 
     SubsuperscriptBox["A", "1", "e"]}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.728776619062687*^9, 
  3.728776619228568*^9}},ExpressionUUID->"e80f5d73-936f-440d-bb16-\
f4c2bbe159ab"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      SubscriptBox["D", "12"], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}]}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["D", "12"], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "-", 
    RowBox[{
     SubscriptBox["D", "12"], ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "-", 
    RowBox[{
     SubscriptBox["D", "13"], ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["D", "13"], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "-", 
    RowBox[{
     SubscriptBox["D", "13"], ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "-", 
    RowBox[{
     SubscriptBox["J", "14"], ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["J", "14"], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "-", 
    RowBox[{
     SubscriptBox["J", "14"], ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "+", 
    RowBox[{"2", " ", 
     SubsuperscriptBox["A", "1", "e"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.728776622227976*^9},ExpressionUUID->"3c5efa02-2b24-443d-863e-\
d4ce45f2d5a2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"The", " ", "sum", " ", "of", " ", "the", " ", "above", " ", 
   SubscriptBox["D", "ij"], " ", "terms", " ", "and", " ", 
   SubscriptBox["J", "ij"], " ", "terms", " ", "are", " ", "both", " ", 
   RowBox[{"zero", ".", " ", "Hence"}]}], ",", " ", 
  RowBox[{
  "the", " ", "above", " ", "euqation", " ", "can", " ", "be", " ", "simpled",
    " ", "as", " "}]}]], "Input",
 CellChangeTimes->{{3.7287765010511417`*^9, 
  3.7287765856675167`*^9}},ExpressionUUID->"0f5c626d-ad91-4e88-9330-\
0d303d486855"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{
   SubsuperscriptBox["A", "1", "e"], "/", "2"}]}]], "Input",
 CellChangeTimes->{{3.72877658912707*^9, 
  3.728776650268901*^9}},ExpressionUUID->"66a4ac26-6903-4739-8eff-\
f9bc9ec09d04"],

Cell[BoxData[
 SubsuperscriptBox["A", "1", "e"]], "Output",
 CellChangeTimes->{
  3.728776636711664*^9},ExpressionUUID->"74913197-3132-4e5e-8c94-\
c8f4ff721d14"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"a", ")"}], " ", "If", " ", "the", " ", "ion", " ", "has", " ", 
    "very", " ", "low", " ", "symmetry"}], ",", " ", 
   RowBox[{
   "and", " ", "hence", " ", "we", " ", "have", " ", "to", " ", "evalue", " ",
     "all", " ", "the", " ", "coefficients", " ", "in"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SIA", " ", "=", " ", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["A", 
       RowBox[{"i", ",", "xx"}], "e"], 
      SubsuperscriptBox["S", "x", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["A", 
       RowBox[{"i", ",", "yy"}], "e"], 
      SubsuperscriptBox["S", "y", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["A", 
       RowBox[{"i", ",", "zz"}], "e"], 
      SubsuperscriptBox["S", "z", "2"]}], "+", 
     RowBox[{"2", 
      SubsuperscriptBox["A", 
       RowBox[{"i", ",", "xy"}], "e"], 
      SubscriptBox["S", "x"], 
      SubscriptBox["S", "y"]}], "+", 
     RowBox[{"2", 
      SubsuperscriptBox["A", 
       RowBox[{"i", ",", "xz"}], "e"], 
      SubscriptBox["S", "x"], 
      SubscriptBox["S", "z"]}], "+", 
     RowBox[{"2", 
      SubsuperscriptBox["A", 
       RowBox[{"i", ",", "yz"}], "e"], 
      SubscriptBox["S", "y"], 
      SubscriptBox["S", "z"]}]}]}], ",", " ", 
   RowBox[{"in", " ", "other", " ", "words"}], ",", " ", 
   RowBox[{"we", " ", "have", " ", "to", " ", "solve"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"SIA", "=", " ", 
  RowBox[{
   SubsuperscriptBox["A", "i", "e"], 
   SubsuperscriptBox["S", "z", "2"]}]}]}], "Input",
 CellChangeTimes->{{3.728776699180726*^9, 
  3.728776760241085*^9}},ExpressionUUID->"917b9ad5-bfd7-42b2-a7cf-\
79e664634943"]
},
WindowSize->{808, 756},
WindowMargins->{{Automatic, 91}, {Automatic, 35}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 3, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1632, 34, 187, "Input",ExpressionUUID->"b2c4025f-2b36-44b5-9a33-28e2ce64e343"],
Cell[2193, 56, 846, 23, 40, "Input",ExpressionUUID->"db3f88eb-a34b-4599-9e25-61b4272dc0f0"],
Cell[CellGroupData[{
Cell[3064, 83, 5977, 185, 577, "Input",ExpressionUUID->"54ab9477-c8d9-406f-985f-8fc176bad10e"],
Cell[9044, 270, 352, 10, 34, "Output",ExpressionUUID->"fc017f39-0936-45b2-86c6-769ee1a25ed5"],
Cell[9399, 282, 371, 11, 34, "Output",ExpressionUUID->"d981b095-4227-4e49-af27-b98c0a793f16"],
Cell[9773, 295, 371, 11, 34, "Output",ExpressionUUID->"8bc2af18-056d-4e15-baa3-70bb36da5a2a"],
Cell[10147, 308, 352, 10, 34, "Output",ExpressionUUID->"c976d981-9f7b-4a66-a8f8-b45852b13293"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10536, 323, 799, 22, 52, "Input",ExpressionUUID->"848a52a9-dc82-4615-8eaa-852127824fb8"],
Cell[11338, 347, 303, 6, 34, "Output",ExpressionUUID->"b8c3b044-ca64-4c21-b3d8-a35a1c8b231e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11678, 358, 572, 17, 30, "Input",ExpressionUUID->"71cccd8e-d357-4b7a-a7af-0ec36a9aff47"],
Cell[12253, 377, 244, 5, 34, "Output",ExpressionUUID->"a27ab67a-f87e-41c7-a0a1-d851d9486bfa"]
}, Open  ]],
Cell[12512, 385, 2043, 58, 128, "Input",ExpressionUUID->"89e49607-9600-4db3-a340-f73e540bf67d"],
Cell[CellGroupData[{
Cell[14580, 447, 10501, 321, 812, "Input",ExpressionUUID->"6beb5fd1-0898-4e28-b54a-d87b27b29ca1"],
Cell[25084, 770, 198, 4, 34, "Output",ExpressionUUID->"88dbcfe6-2b05-4711-8eb0-cc147c8cafb1"],
Cell[25285, 776, 914, 30, 34, "Output",ExpressionUUID->"a8ed7243-7b90-40bc-bc1e-fb7c411c866a"],
Cell[26202, 808, 196, 4, 34, "Output",ExpressionUUID->"9935cebc-cff5-4517-9172-056e827861fa"],
Cell[26401, 814, 977, 33, 34, "Output",ExpressionUUID->"cdcb9133-701d-4a9e-8e45-f645b29d170d"],
Cell[27381, 849, 196, 4, 34, "Output",ExpressionUUID->"a865b86a-8b4e-42ab-98fb-182ffb551cdd"],
Cell[27580, 855, 893, 29, 34, "Output",ExpressionUUID->"8108299c-9eea-4567-bf55-b47fadea2997"],
Cell[28476, 886, 198, 4, 34, "Output",ExpressionUUID->"353c14d7-2389-4e5d-b9df-0a77f6b0aaf5"],
Cell[28677, 892, 914, 30, 34, "Output",ExpressionUUID->"133bafd2-204b-4b1b-8fb3-7b4ec78c1a9a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29628, 927, 925, 25, 52, "Input",ExpressionUUID->"39581327-84c9-4c38-b330-51ff37cfeb59"],
Cell[30556, 954, 551, 19, 50, "Output",ExpressionUUID->"55c91875-5f8b-4763-b739-72aaad4b4a5d"]
}, Open  ]],
Cell[31122, 976, 1172, 31, 73, "Input",ExpressionUUID->"1090f885-4701-44b0-aa36-7aa8c710976d"],
Cell[CellGroupData[{
Cell[32319, 1011, 781, 24, 47, "Input",ExpressionUUID->"91627650-7300-41dc-9289-ecff7a51d216"],
Cell[33103, 1037, 155, 4, 34, "Output",ExpressionUUID->"c84c3adc-c6f2-4632-89c8-a3a346499c64"]
}, Open  ]],
Cell[33273, 1044, 1800, 50, 76, "Input",ExpressionUUID->"6f512e01-619b-479a-bf46-2876c7a1cf5a"],
Cell[35076, 1096, 753, 21, 74, "Input",ExpressionUUID->"929a2f1e-0d08-4e7c-bead-e05a3a113949"],
Cell[CellGroupData[{
Cell[35854, 1121, 11903, 369, 876, "Input",ExpressionUUID->"ef5b8695-e9c2-417b-b7dd-34b7faf5936b"],
Cell[47760, 1492, 406, 11, 34, "Output",ExpressionUUID->"2b31dcb7-ca87-49cd-88ee-9c1d2e07e9e6"],
Cell[48169, 1505, 904, 29, 34, "Output",ExpressionUUID->"a99b1211-4bbe-4455-944c-c9d2fb00f363"],
Cell[49076, 1536, 378, 9, 36, "Output",ExpressionUUID->"1f865311-f1f5-4c63-ad92-3ab7234305c1"],
Cell[49457, 1547, 425, 12, 34, "Output",ExpressionUUID->"b9747836-4a3f-4a66-95a9-64f66277be09"],
Cell[49885, 1561, 904, 29, 34, "Output",ExpressionUUID->"f52a976b-e249-4d84-a317-b8684facc25c"],
Cell[50792, 1592, 376, 9, 36, "Output",ExpressionUUID->"fac71ba9-6a40-4764-baff-bdc348d60c5c"],
Cell[51171, 1603, 307, 8, 34, "Output",ExpressionUUID->"802db2e6-91c1-4056-a7f6-e539453bacc6"],
Cell[51481, 1613, 967, 32, 34, "Output",ExpressionUUID->"6343ad90-45cb-4230-9f84-1cc1c0867393"],
Cell[52451, 1647, 334, 8, 36, "Output",ExpressionUUID->"e9e3545a-630d-4966-86af-104bdfc14811"],
Cell[52788, 1657, 307, 8, 34, "Output",ExpressionUUID->"2a4db106-fcb7-42fd-a85a-2e44a4ee8d40"],
Cell[53098, 1667, 904, 29, 34, "Output",ExpressionUUID->"93a671ac-ec30-4510-97cf-05e83f814854"],
Cell[54005, 1698, 333, 8, 36, "Output",ExpressionUUID->"87ff0f09-efba-45e3-87f9-c0a5ea46d1aa"]
}, Open  ]],
Cell[54353, 1709, 1179, 32, 94, "Input",ExpressionUUID->"db0075c0-ddd5-4819-a8b7-8aa54d8a4daa"],
Cell[CellGroupData[{
Cell[55557, 1745, 1590, 52, 72, InheritFromParent,ExpressionUUID->"e80f5d73-936f-440d-bb16-f4c2bbe159ab"],
Cell[57150, 1799, 1567, 52, 74, "Output",ExpressionUUID->"3c5efa02-2b24-443d-863e-d4ce45f2d5a2"]
}, Open  ]],
Cell[58732, 1854, 535, 11, 54, "Input",ExpressionUUID->"0f5c626d-ad91-4e88-9330-0d303d486855"],
Cell[CellGroupData[{
Cell[59292, 1869, 230, 6, 33, "Input",ExpressionUUID->"66a4ac26-6903-4739-8eff-f9bc9ec09d04"],
Cell[59525, 1877, 161, 4, 36, "Output",ExpressionUUID->"74913197-3132-4e5e-8c94-c8f4ff721d14"]
}, Open  ]],
Cell[59701, 1884, 1715, 50, 98, "Input",ExpressionUUID->"917b9ad5-bfd7-42b2-a7cf-79e664634943"]
}
]
*)

